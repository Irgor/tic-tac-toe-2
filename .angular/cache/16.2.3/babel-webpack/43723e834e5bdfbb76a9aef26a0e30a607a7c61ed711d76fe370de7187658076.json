{"ast":null,"code":"var _class;\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/services/moves-controll.service\";\nimport * as i2 from \"@angular/common\";\nimport * as i3 from \"../../components/field/field.component\";\nfunction GameComponent_div_3_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 5);\n    i0.ɵɵelement(1, \"app-field\", 6)(2, \"div\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const j_r5 = ctx.index;\n    const i_r2 = i0.ɵɵnextContext().index;\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"i\", i_r2)(\"j\", j_r5);\n  }\n}\nfunction GameComponent_div_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 3);\n    i0.ɵɵtemplate(1, GameComponent_div_3_div_1_Template, 3, 2, \"div\", 4);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const fieldRow_r1 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", fieldRow_r1);\n  }\n}\nclass GameComponent {\n  constructor(moveControll) {\n    this.moveControll = moveControll;\n    this.fieldMap = [['', '', ''], ['', '', ''], ['', '', '']];\n    this.controllField = [['', '', ''], ['', '', ''], ['', '', '']];\n    this.nextMove = '';\n    this.endedGames = [];\n    this.moveControll.endedGames.next([]);\n  }\n  ngOnInit() {\n    this.endedGamesSub = this.moveControll.endedGames.subscribe({\n      next: games => {\n        this.endedGames = games;\n        for (let game of games) {\n          this.controllField[game.i][game.j] = game.winner;\n        }\n        this.checkDraw();\n        this.checkWin();\n      }\n    });\n    this.moveSub = this.moveControll.gameToMove.subscribe({\n      next: game => {\n        this.nextMove = game.mover;\n      }\n    });\n  }\n  checkDraw() {\n    if (this.endedGames.length == 9) {\n      //TODO DRAW      \n      console.log('DRAW');\n    }\n  }\n  checkWin() {\n    for (let i of this.controllField) {\n      this.getRow(i);\n    }\n    for (let i = 0; i < this.controllField.length; i++) {\n      let line = [this.controllField[0][i], this.controllField[1][i], this.controllField[2][i]];\n      this.getRow(line);\n    }\n    let leftDiag = [this.controllField[0][0], this.controllField[1][1], this.controllField[2][2]];\n    this.getRow(leftDiag);\n    let rightDiag = [this.controllField[2][0], this.controllField[1][1], this.controllField[0][2]];\n    this.getRow(rightDiag);\n  }\n  getRow(row) {\n    const line = row[0] + row[1] + row[2];\n    let winner = Array.from(new Set(line.split('')));\n    let win = winner.length == 1 && line.length == 3;\n    if (win) {\n      alert('O VENCEDOR É O ' + winner);\n    }\n  }\n  ngOnDestroy() {\n    this.endedGamesSub?.unsubscribe();\n    this.moveSub?.unsubscribe();\n  }\n}\n_class = GameComponent;\n_class.ɵfac = function GameComponent_Factory(t) {\n  return new (t || _class)(i0.ɵɵdirectiveInject(i1.MovesControllService));\n};\n_class.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: _class,\n  selectors: [[\"app-game\"]],\n  decls: 4,\n  vars: 2,\n  consts: [[1, \"next-move\"], [1, \"field-holder\"], [\"class\", \"col\", 4, \"ngFor\", \"ngForOf\"], [1, \"col\"], [\"class\", \"row sqr\", 4, \"ngFor\", \"ngForOf\"], [1, \"row\", \"sqr\"], [3, \"i\", \"j\"]],\n  template: function GameComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"div\", 0);\n      i0.ɵɵtext(1);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(2, \"div\", 1);\n      i0.ɵɵtemplate(3, GameComponent_div_3_Template, 2, 1, \"div\", 2);\n      i0.ɵɵelementEnd();\n    }\n    if (rf & 2) {\n      i0.ɵɵadvance(1);\n      i0.ɵɵtextInterpolate1(\" \", ctx.nextMove, \"\\n\");\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"ngForOf\", ctx.fieldMap);\n    }\n  },\n  dependencies: [i2.NgForOf, i3.FieldComponent],\n  styles: [\".field-holder[_ngcontent-%COMP%] {\\n  display: flex;\\n  flex-direction: row;\\n  justify-content: center;\\n  align-items: center;\\n}\\n\\n.next-move[_ngcontent-%COMP%] {\\n  font-family: \\\"Nunito\\\", sans-serif;\\n  font-size: 10rem;\\n  position: absolute;\\n  top: 50px;\\n  left: 50px;\\n  -webkit-user-select: none;\\n          user-select: none;\\n}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvcGFnZXMvZ2FtZS9nYW1lLmNvbXBvbmVudC5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0ksYUFBQTtFQUNBLG1CQUFBO0VBQ0EsdUJBQUE7RUFDQSxtQkFBQTtBQUNKOztBQUVBO0VBQ0ksaUNBQUE7RUFDQSxnQkFBQTtFQUNBLGtCQUFBO0VBQ0EsU0FBQTtFQUNBLFVBQUE7RUFDQSx5QkFBQTtVQUFBLGlCQUFBO0FBQ0oiLCJzb3VyY2VzQ29udGVudCI6WyIuZmllbGQtaG9sZGVyIHtcclxuICAgIGRpc3BsYXk6IGZsZXg7XHJcbiAgICBmbGV4LWRpcmVjdGlvbjogcm93O1xyXG4gICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7XHJcbiAgICBhbGlnbi1pdGVtczogY2VudGVyO1xyXG59XHJcblxyXG4ubmV4dC1tb3ZlIHtcclxuICAgIGZvbnQtZmFtaWx5OiAnTnVuaXRvJywgc2Fucy1zZXJpZjtcclxuICAgIGZvbnQtc2l6ZTogMTByZW07XHJcbiAgICBwb3NpdGlvbjogYWJzb2x1dGU7XHJcbiAgICB0b3A6IDUwcHg7XHJcbiAgICBsZWZ0OiA1MHB4O1xyXG4gICAgdXNlci1zZWxlY3Q6IG5vbmU7XHJcbn0iXSwic291cmNlUm9vdCI6IiJ9 */\"]\n});\nexport { GameComponent };","map":{"version":3,"names":["i0","ɵɵelementStart","ɵɵelement","ɵɵelementEnd","ɵɵadvance","ɵɵproperty","i_r2","j_r5","ɵɵtemplate","GameComponent_div_3_div_1_Template","fieldRow_r1","GameComponent","constructor","moveControll","fieldMap","controllField","nextMove","endedGames","next","ngOnInit","endedGamesSub","subscribe","games","game","i","j","winner","checkDraw","checkWin","moveSub","gameToMove","mover","length","console","log","getRow","line","leftDiag","rightDiag","row","Array","from","Set","split","win","alert","ngOnDestroy","unsubscribe","ɵɵdirectiveInject","i1","MovesControllService","selectors","decls","vars","consts","template","GameComponent_Template","rf","ctx","ɵɵtext","GameComponent_div_3_Template","ɵɵtextInterpolate1"],"sources":["C:\\Users\\igorn\\tic-tac-toe-2\\src\\app\\pages\\game\\game.component.ts","C:\\Users\\igorn\\tic-tac-toe-2\\src\\app\\pages\\game\\game.component.html"],"sourcesContent":["import { Component, OnInit, OnDestroy } from '@angular/core';\nimport { Subscription } from 'rxjs';\nimport { MovesControllService } from 'src/app/services/moves-controll.service';\n\n@Component({\n  selector: 'app-game',\n  templateUrl: './game.component.html',\n  styleUrls: ['./game.component.scss']\n})\nexport class GameComponent implements OnInit, OnDestroy {\n  fieldMap = [\n    ['', '', ''],\n    ['', '', ''],\n    ['', '', ''],\n  ]\n\n  controllField = [\n    ['', '', ''],\n    ['', '', ''],\n    ['', '', ''],\n  ]\n\n  nextMove = '';\n  endedGames: any = [];\n\n  endedGamesSub?: Subscription;\n  moveSub?: Subscription;\n\n  constructor(private moveControll: MovesControllService) {\n    this.moveControll.endedGames.next([]);\n  }\n\n  ngOnInit(): void {\n    this.endedGamesSub = this.moveControll.endedGames.subscribe({\n      next: games => {\n        this.endedGames = games;\n        for (let game of games) {\n          this.controllField[game.i][game.j] = game.winner;\n        }\n        this.checkDraw();\n        this.checkWin();\n      }\n    });\n\n    this.moveSub = this.moveControll.gameToMove.subscribe({\n      next: game => {\n        this.nextMove = game.mover;\n      }\n    })\n  }\n\n  checkDraw() {\n    if (this.endedGames.length == 9) {\n      //TODO DRAW      \n      console.log('DRAW');\n    }\n  }\n\n  checkWin() {\n    for (let i of this.controllField) {\n      this.getRow(i);\n    }\n\n    for (let i = 0; i < this.controllField.length; i++) {\n      let line = [this.controllField[0][i], this.controllField[1][i], this.controllField[2][i]];\n      this.getRow(line);\n    }\n\n    let leftDiag = [this.controllField[0][0], this.controllField[1][1], this.controllField[2][2]];\n    this.getRow(leftDiag);\n\n    let rightDiag = [this.controllField[2][0], this.controllField[1][1], this.controllField[0][2]];\n    this.getRow(rightDiag);\n  }\n\n\n  getRow(row: string[]) {\n    const line = row[0] + row[1] + row[2];\n    let winner = Array.from(new Set(line.split('')));\n    let win = winner.length == 1 && line.length == 3;\n\n    if (win) {\n      alert('O VENCEDOR É O ' + winner)\n    }\n  }\n\n  ngOnDestroy(): void {\n    this.endedGamesSub?.unsubscribe();\n    this.moveSub?.unsubscribe();\n  }\n\n}\n","<div class=\"next-move\">\r\n    {{nextMove}}\r\n</div>\r\n<div class=\"field-holder\">\r\n    <div *ngFor=\"let fieldRow of fieldMap; index as i\" class=\"col\">\r\n        <div *ngFor=\"let field of fieldRow; index as j\" class=\"row sqr\">\r\n            <app-field [i]=\"i\" [j]=\"j\"></app-field>\r\n        <div>\r\n    </div>\r\n</div>"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}